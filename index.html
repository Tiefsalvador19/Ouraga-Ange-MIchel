<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ouraga Ange-Michel ‚Äî EDHEG Campaign</title>

  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- AOS (Animate On Scroll) -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css" rel="stylesheet">
  <!-- Font Awesome -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

  <style>
    :root{
      --primary:#0d6efd;
      --accent:#ff7a00;
      --muted:#6c757d;
      --glass: rgba(255,255,255,0.75);
    }
    body{background: linear-gradient(180deg,#f6f9ff 0%, #ffffff 100%); color:#222}
    .hero{background: linear-gradient(90deg, rgba(13,110,253,0.06), rgba(255,122,0,0.03)); padding:6rem 0}
    .card-ghost{background:var(--glass); backdrop-filter: blur(6px); border-radius:1rem}
    .pill{display:inline-flex; align-items:center; gap:.5rem; background:#fff; padding:.35rem .7rem; border-radius:999px}
    .progress-wrap{height:18px; border-radius:999px; background:#e9ecef}
    .nav-brand{font-weight:700}
    .cta-btn{background:var(--primary); color:#fff}
    .hero-img{max-width:480px; width:100%; border-radius:1rem}
    footer{padding:2.5rem 0}
    .error-box{display:none;padding:.75rem;border-radius:.5rem;background:#fff3f2;border:1px solid #ffccd0;color:#9b111e;margin-top:.5rem}
    .loader{display:none}
    @media (max-width:768px){ .hero{padding:3rem 0} }
  </style>
</head>
<body>

<!-- NAVBAR -->
<nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm sticky-top">
  <div class="container">
    <a class="navbar-brand nav-brand" href="#">Ouraga Ange-Michel</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navMenu">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navMenu">
      <ul class="navbar-nav ms-auto align-items-lg-center">
        <li class="nav-item"><a class="nav-link" href="#about">√Ä propos</a></li>
        <li class="nav-item"><a class="nav-link" href="#program">Programme</a></li>
        <li class="nav-item"><a class="nav-link" href="#roadmap">Roadmap</a></li>
        <li class="nav-item"><a class="nav-link" href="#join">Rejoindre</a></li>
        <li class="nav-item ms-3"><a class="btn btn-primary btn-animate" href="#vote">Voter</a></li>
      </ul>
    </div>
  </div>
</nav>

<!-- HERO -->
<section class="hero">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-lg-6" data-aos="fade-right">
        <h1 class="display-5 fw-bold">Le leadership qui sert, inspire et unit.</h1>
        <p class="lead text-muted">Ouraga Ange-Michel ‚Äî √âtudiant IDEA, d√©veloppeur & chef de projet. Ensemble, rendons l'EDHEG plus vivante, plus solidaire et plus innovante.</p>
        <div class="d-flex gap-3 mt-4">
          <a class="btn cta-btn btn-lg btn-animate" href="#program">D√©couvrir le programme</a>
          <a class="btn btn-outline-secondary btn-lg" href="#join">Rejoindre l'√©quipe</a>
        </div>
      </div>
      <div class="col-lg-6 text-center" data-aos="fade-left">
        <img src="https://images.unsplash.com/photo-1544005313-94ddf0286df2?q=80&w=1200&auto=format&fit=crop&s=placeholder" alt="Ouraga" class="hero-img mt-4 mt-lg-0">
      </div>
    </div>
  </div>
</section>

<!-- ABOUT, PROGRAM, ROADMAP, JOIN ... -->
<!-- (conserve tout le contenu de ton template ici - inchang√©) -->
<!-- Pour la lisibilit√© j'ai omis ici les sections inchang√©es ‚Äî garde ton template original. -->

<!-- ======= SECTION STATISTIQUES (INS√âR√âE AVANT LE FOOTER) ======= -->
<section id="stats" class="py-5 bg-light">
  <div class="container">
    <div class="text-center mb-4" data-aos="fade-up">
      <h2>Statistiques en temps r√©el</h2>
      <p class="text-muted">Votes et membres inscrits ‚Äî donn√©es affich√©es directement depuis notre Hub.</p>
      <div id="globalError" class="error-box" role="alert"></div>
    </div>

    <div class="row g-4">
      <div class="col-lg-6">
        <div class="card p-4 shadow-sm">
          <div class="d-flex justify-content-between align-items-center mb-3">
            <h5 class="mb-0">üó≥Ô∏è Votes re√ßus</h5>
            <div id="voteLoader" class="loader">Chargement‚Ä¶</div>
          </div>
          <div class="text-center mb-3">
            <div id="voteCount" class="fs-1 fw-bold">0</div>
            <small class="text-muted">Total</small>
          </div>

          <div class="table-responsive">
            <table class="table table-sm table-bordered" id="tableVotants">
              <thead class="table-dark">
                <tr><th>Nom</th><th>Fili√®re</th><th>Niveau</th><th>Email</th><th>WhatsApp</th><th>Motivation</th></tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
          <div id="voteError" class="error-box" style="display:none;"></div>
        </div>
      </div>

      <div class="col-lg-6">
        <div class="card p-4 shadow-sm">
          <div class="d-flex justify-content-between align-items-center mb-3">
            <h5 class="mb-0">üë• Membres inscrits</h5>
            <div id="inscritLoader" class="loader">Chargement‚Ä¶</div>
          </div>
          <div class="text-center mb-3">
            <div id="inscritCount" class="fs-1 fw-bold text-success">0</div>
            <small class="text-muted">Total inscrits</small>
          </div>

          <div class="table-responsive">
            <table class="table table-sm table-bordered" id="tableInscrits">
              <thead class="table-primary">
                <tr><th>Nom</th><th>Email</th><th>WhatsApp</th><th>Fili√®re</th><th>Niveau</th><th>Motivation</th><th>R√¥le</th></tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
          <div id="inscritError" class="error-box" style="display:none;"></div>
        </div>
      </div>
    </div>

    <div class="text-center mt-4">
      <small class="text-muted">Les donn√©es sont mises √† jour automatiquement lorsque la page est charg√©e.</small>
    </div>
  </div>
</section>

<!-- FOOTER -->
<footer class="bg-white border-top">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-md-6 py-3">
        <small>¬© <strong>Ouraga Ange-Michel</strong> ‚Äî Campagne EDHEG ‚Ä¢ Tous droits r√©serv√©s</small>
      </div>
      <div class="col-md-6 text-md-end py-3">
        <a class="me-3"><i class="fa-brands fa-facebook"></i></a>
        <a class="me-3"><i class="fa-brands fa-instagram"></i></a>
        <a class="me-3"><i class="fa-brands fa-linkedin"></i></a>
      </div>
    </div>
  </div>
</footer>

<!-- SCRIPTS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>

<script>
AOS.init({duration:800, once:true});

// ---------- CONFIG API (tes WebApps)
const API_VOTES = "https://script.google.com/macros/s/AKfycbysj7HPHPikJ0XAn1_3pSdg_Pwae5SxnfYn666Oy9bdyg0GH1JNVdj8LsEwazEQqnXl7g/exec";
const API_INSCRITS = "https://script.google.com/macros/s/AKfycbwveDZRaNIe1Z9WzfedgQttl92axaDeBzmgDosRWI0vA-NK2N4LAV_PeENNDUqnPOI4/exec";

// Utilitaires
function urlValide(u){ try{ new URL(u); return true } catch(e){ return false } }
function show(el, txt){ el.style.display = txt ? 'block' : 'none'; if(txt) el.textContent = txt; }
function safeText(s){ return (s===null || s===undefined) ? '' : String(s); }

// Wrapper fetch avec parsing s√ªr et message d'erreur explicite
async function fetchJSON(url){
  const res = await fetch(url, {mode:'cors'});
  if(!res.ok) throw new Error('HTTP ' + res.status);
  const text = await res.text();
  try { return JSON.parse(text); }
  catch(e){ throw new Error('R√©ponse non-JSON : ' + text.substring(0,200)); }
}

// Remplir table ‚Äî helpers
function appendRow(tableBody, cells){
  const tr = document.createElement('tr');
  tr.innerHTML = cells.map(c => `<td>${safeText(c)}</td>`).join('');
  tableBody.appendChild(tr);
}

// Charger votes
async function chargerVotes(){
  const voteError = document.getElementById('voteError');
  show(voteError, '');
  try{
    if(!urlValide(API_VOTES)) throw new Error('URL votes invalide');
    const json = await fetchJSON(API_VOTES);

    // plusieurs formats possibles : { rows: [...] } ou tableau direct
    const rows = Array.isArray(json.rows) ? json.rows : (Array.isArray(json) ? json : []);
    document.getElementById('voteCount').textContent = rows.length;

    const tbody = document.querySelector('#tableVotants tbody');
    tbody.innerHTML = '';
    rows.forEach(r => {
      // prise en charge d'un tableau de colonnes ou d'un objet
      if(Array.isArray(r)){
        // indices attendus : [id, Nom, Fili√®re, Niveau, Email, WhatsApp, Motivation,...]
        appendRow(tbody, [r[1], r[2], r[3], r[4], r[5], r[6]]);
      } else {
        appendRow(tbody, [r['Nom complet']||r.name, r['Fili√®re'], r['Niveau'], r['Email'], r['WhatsApp']||r['Num√©ro WhatsApp'], r['Motivation']||r['Pourquoi']]);
      }
    });
    return true;
  }catch(err){
    show(voteError, '‚ùå Erreur chargement votes ‚Äî ' + err.message);
    console.error(err);
    return false;
  }
}

// Charger inscrits
async function chargerInscrits(){
  const inscritError = document.getElementById('inscritError');
  show(inscritError, '');
  try{
    if(!urlValide(API_INSCRITS)) throw new Error('URL inscrits invalide');
    const json = await fetchJSON(API_INSCRITS);

    // plusieurs formats possibles
    const rows = Array.isArray(json.rows) ? json.rows : (Array.isArray(json) ? json : []);
    document.getElementById('inscritCount').textContent = rows.length;

    const tbody = document.querySelector('#tableInscrits tbody');
    tbody.innerHTML = '';
    rows.forEach(r => {
      if(Array.isArray(r)){
        appendRow(tbody, [r[1], r[2], r[3], r[4], r[5], r[6], r[7]]);
      } else {
        appendRow(tbody, [r['Nom complet']||r.name, r['Email']||r.email, r['WhatsApp']||r.phone, r['Fili√®re'], r['Niveau'], r['Motivation'], r['R√¥le souhait√©']||r.role]);
      }
    });
    return true;
  }catch(err){
    show(inscritError, '‚ùå Erreur chargement inscrits ‚Äî ' + err.message);
    console.error(err);
    return false;
  }
}

// Charge tout et affiche message global si probl√®me
window.addEventListener('DOMContentLoaded', async ()=>{
  const globalError = document.getElementById('globalError');
  globalError.style.display = 'none';

  // Essayer de charger les deux
  const okVotes = await chargerVotes().catch(()=>false);
  const okInscrits = await chargerInscrits().catch(()=>false);

  if(!okVotes || !okInscrits){
    globalError.style.display = 'block';
    globalError.innerHTML = 'Impossible de charger les APIs. V√©rifie : <b>d√©ploiement WebApp</b>, <b>Acc√®s = Tout le monde</b>, et re-d√©ploie si n√©cessaire.';
  }
});
</script>

</body>
</html>
