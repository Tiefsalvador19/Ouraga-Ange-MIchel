<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Ouraga Ange-Michel ‚Äî Campagne EDHEG : Leader, Action, Innovation</title>
  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- AOS (Animate On Scroll) -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css" rel="stylesheet">
  <!-- Font Awesome Icons -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

  <style>
    /* CSS pour un look chic et percutant */
    :root{
      --primary:#0d6efd; /* Bleu dominant */
      --accent:#ff7a00; /* Orange percutant */
      --muted:#6c757d;
      --glass: rgba(255,255,255,0.75);
    }
    body{background: linear-gradient(180deg,#f6f9ff 0%, #ffffff 100%); color:#222}
    .hero{background: linear-gradient(90deg, rgba(13,110,253,0.06), rgba(255,122,0,0.03)); padding:6rem 0}
    .card-ghost{background:var(--glass); backdrop-filter: blur(6px); border-radius:1rem}
    .nav-brand{font-weight:700; letter-spacing:.2px}
    .cta-btn{background:var(--primary); color:#fff}
    .btn-animate:hover{transform:translateY(-4px); transition:all .25s ease}
    .hero-img{max-width:480px; width:100%; border-radius:1rem; box-shadow:0 10px 40px rgba(13,110,253,0.08)}

    /* Styles de la section Statistique */
    .stat-box{padding:20px; text-align:center; background:#fff; border-radius:10px; box-shadow:0 4px 10px rgba(0,0,0,0.05); min-height: 400px;}
    .stat-number{font-size:3rem; font-weight:700; color:var(--accent)}
    .stat-error{background-color:#f8d7da; color:#721c24; border:1px solid #f5c6cb; padding:15px; border-radius:5px; margin-bottom:20px; font-weight: bold;}
    .table-responsive{max-height: 220px; overflow-y: auto; text-align: left;} 
  </style>
</head>
<body>

<!-- NAVBAR -->
<nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm sticky-top">
  <div class="container">
    <a class="navbar-brand nav-brand" href="#">ANGE-MICHEL | EDHEG</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navMenu">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navMenu">
      <ul class="navbar-nav ms-auto align-items-lg-center">
        <li class="nav-item"><a class="nav-link" href="#about">Mon Parcours</a></li>
        <li class="nav-item"><a class="nav-link" href="#program">Programme SMART</a></li>
        <li class="nav-item"><a class="nav-link" href="#stats">Statistiques Live</a></li>
        <li class="nav-item"><a class="nav-link" href="#join">Soutenir / Rejoindre</a></li>
        <li class="nav-item ms-3"><a class="btn btn-primary btn-animate" href="#join">Voter / Soutenir</a></li>
      </ul>
    </div>
  </div>
</nav>

<!-- HERO SECTION (√Ä Remplir avec votre contenu persuasif) -->
<section class="hero">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-lg-6" data-aos="fade-right">
        <h1 class="display-5 fw-bold">Un Leader, Une Vision : L'Action et l'Innovation.</h1>
        <p class="lead text-muted">√âtudiant IDEA, laur√©at ECOCIR, chef de projet. **Mon engagement :** transformer nos frustrations en opportunit√©s. Ensemble, faisons vivre notre √©cole !</p>
        <div class="d-flex gap-3 mt-4">
          <a class="btn cta-btn btn-lg btn-animate" href="#program">D√©couvrir le programme SMART</a>
          <a class="btn btn-outline-secondary btn-lg" href="#join">Rejoindre l'√©quipe</a>
        </div>

        <!-- Compteurs Dynamiques -->
        <div class="mt-4">
          <div class="row g-2">
            <div class="col-6">
              <div class="card p-3 card-ghost">
                <div class="d-flex align-items-center">
                  <i class="fa-solid fa-vote-yea fa-2x me-3" style="color:var(--primary)"></i>
                  <div>
                    <small class="text-muted">Total Soutiens (Live)</small>
                    <div class="fw-bold fs-5" id="live-votes">0</div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-6">
              <div class="card p-3 card-ghost">
                <div class="d-flex align-items-center">
                  <i class="fa-solid fa-users-gear fa-2x me-3" style="color:var(--accent)"></i>
                  <div>
                    <small class="text-muted">√âquipe Recrut√©e (Live)</small>
                    <div class="fw-bold fs-5" id="live-members">0</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-lg-6 text-center" data-aos="fade-left">
        <!-- IMAGE DE PROFIL -->
        <img src="https://images.unsplash.com/photo-1544005313-94ddf0286df2?q=80&w=1200&auto=format&fit=crop&s=placeholder" alt="Ouraga Ange-Michel" class="hero-img mt-4 mt-lg-0">
      </div>
    </div>
  </div>
</section>

<!-- PROGRAM SECTION (√Ä Compl√©ter) -->
<section id="program" class="py-5">
    <div class="container">
        <!-- Ins√©rez ici les 4 piliers SMART -->
        <h2 class="text-center mb-5">üéØ Notre Programme en 4 Axes SMART</h2>
        <p class="text-center lead">**1. Communication efficace, 2. Coh√©sion & solidarit√©, 3. Vie √©tudiante active, 4. Innovation & opportunit√©s.**</p>
    </div>
</section>
<!-- ... -->

<!-- STATS EN TEMPS R√âEL (MISES √Ä JOUR) -->
<section id="stats" class="py-5 bg-light">
    <div class="container">
        <div class="text-center mb-5" data-aos="fade-up">
            <h2>Statistiques en Temps R√©el üìä</h2>
            <p class="lead text-muted">Transparence totale : soutiens et membres affich√©s en direct via notre Hub IDEA (Google Sheets & Apps Script).</p>
        </div>
        
        <div class="stat-error d-none" id="fetch-error">
            <i class="fas fa-exclamation-triangle me-2"></i> **Probl√®me de connexion !** Impossible de charger les donn√©es. V√©rifiez vos URL Apps Script.
        </div>

        <div class="row g-4">
            <!-- VOTES / SOUTIEN -->
            <div class="col-lg-6">
                <div class="stat-box h-100" data-aos="fade-up">
                    <i class="fas fa-vote-yea fa-3x text-primary mb-3"></i>
                    <h4>Soutien Re√ßu (Votes)</h4>
                    <div class="stat-number" id="total-votes-stat">0</div>
                    
                    <h5 class="mt-4">Derniers Soutiens (Motivation)</h5>
                    <div class="table-responsive">
                        <table class="table table-striped table-sm">
                            <thead>
                                <tr>
                                    <th>Nom</th>
                                    <th>Fili√®re</th>
                                    <th>Motivation</th>
                                </tr>
                            </thead>
                            <tbody id="votes-list-body">
                                <tr><td colspan="3">Chargement...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- MEMBRES INSCRITS -->
            <div class="col-lg-6">
                <div class="stat-box h-100" data-aos="fade-up" data-aos-delay="100">
                    <i class="fas fa-users-gear fa-3x text-accent mb-3"></i>
                    <h4>Membres Inscrits (√âquipe)</h4>
                    <div class="stat-number" id="total-members-stat">0</div>
                    
                    <h5 class="mt-4">L'√âquipe d'Action (Volontaires)</h5>
                    <div class="table-responsive">
                        <table class="table table-striped table-sm">
                            <thead>
                                <tr>
                                    <th>Nom</th>
                                    <th>Fili√®re</th>
                                    <th>R√¥le</th>
                                </tr>
                            </thead>
                            <tbody id="members-list-body">
                                <tr><td colspan="3">Chargement...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>


<!-- JOIN / CONTACT (Formulaire de Soumission) -->
<section id="join" class="py-5">
  <div class="container">
    <div class="row g-4 align-items-center">
      <div class="col-lg-6" data-aos="fade-up">
        <h3>Rejoins l'√©quipe ou Soutiens ma vision !</h3>
        <p class="lead text-muted">Deux fa√ßons d'agir : voter symboliquement pour ma vision ou devenir un acteur du changement dans l'√©quipe.</p>
      </div>
      <div class="col-lg-6" data-aos="fade-left">
        <div class="card p-4 shadow-lg">
          <h5>Formulaire de Soutien / Recrutement</h5>
          <form id="joinForm">
            <div class="mb-3">
              <label for="nom" class="form-label">Nom complet</label>
              <input type="text" class="form-control" id="nom" name="Nom complet" required>
            </div>
            <div class="mb-3">
              <label for="filiere" class="form-label">Fili√®re / Niveau (ex: IDEA L2, GESTION M1)</label>
              <input type="text" class="form-control" id="filiere" name="Fili√®re / Niveau" required>
            </div>
            <div class="mb-3">
              <label for="role" class="form-label">Je veux...</label>
              <select class="form-select" id="role" name="R√¥le Souhait√©" required>
                  <option value="" disabled selected>Choisir une option</option>
                  <option value="Vote/Soutien Simple">Voter / Apporter mon Soutien (Simple)</option>
                  <option value="Membre Equipe Communication">Devenir Membre (Com. / R√©seaux)</option>
                  <option value="Membre Equipe Evenementiel">Devenir Membre (√âv√©nements / Logistique)</option>
                  <option value="Membre Equipe Projets IDEA">Devenir Membre (Projets Tech / IDEA)</option>
              </select>
            </div>
            <div class="mb-3">
              <label for="motivation" class="form-label">Votre motivation / Message de soutien (max 100 mots)</label>
              <textarea class="form-control" id="motivation" name="Votre motivation" rows="3" required></textarea>
            </div>
            <button class="btn btn-primary w-100 btn-animate" type="submit">Envoyer et Rejoindre le Mouvement</button>
            <div id="form-message" class="mt-3 text-center d-none"></div>
          </form>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- FOOTER -->
<footer class="bg-white border-top">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-md-6 py-3">
        <small>¬© <strong>Ouraga Ange‚ÄëMichel</strong> ‚Äî Campagne EDHEG ‚Ä¢ Construit avec l'esprit IDEA</small>
      </div>
      <div class="col-md-6 text-md-end py-3">
        <a href="#" class="me-3 text-muted"><i class="fa-brands fa-whatsapp"></i></a>
        <a href="#" class="me-3 text-muted"><i class="fa-brands fa-linkedin"></i></a>
      </div>
    </div>
  </div>
</footer>

<!-- SCRIPTS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
<script>
  AOS.init({duration:800, once:true});

  // =================================================================
  // CONFIGURATION GAS API (MISES √Ä JOUR)
  // =================================================================

  // URL pour soumettre les donn√©es (votre script GAS doPost - URL de l'image d0e3fa.png)
  const GAS_POST_URL = 'https://script.google.com/macros/s/AKfycbx8xCVGqbsDxDi115uBX7FVQe54OiQaBv872XIKMbL6XD4SRFrv0YR-2KXQrWM_80i-/exec';

  // URL pour r√©cup√©rer les donn√©es (votre script GAS unifi√© doGet - URL du dernier message utilisateur)
  const GAS_FETCH_URL = 'https://script.google.com/macros/s/AKfycbweqnr98zvtfi2NxV6Ow9YyNGuT-ECl1PCNRa_9rA-hzl_O3iz6slxHWRIfODmJIlq5XQ/exec';
  
  // NOTE: V√©rifiez que GAS_POST_URL pointe vers l'API qui √©crit les donn√©es
  // et GAS_FETCH_URL pointe vers l'API qui lit les donn√©es (celle corrig√©e en Code.gs).

  // =================================================================
  // LOGIQUE JAVASCRIPT DE R√âCUP√âRATION ET D'AFFICHAGE
  // =================================================================

  // Fonction 1 : R√©cup√©rer les donn√©es et mettre √† jour les statistiques
  async function fetchStats() {
      const errorDiv = document.getElementById('fetch-error');
      errorDiv.classList.add('d-none');
      
      try {
          // --- 1. R√âCUP√âRER LES VOTES/SOUTIENS (Feuille "√âlection EDHEG") ---
          // Utilise le param√®tre ?sheet=votes pour cibler la bonne feuille dans votre script GAS unifi√©
          const votesResponse = await fetch(GAS_FETCH_URL + '?sheet=votes'); 
          const votesData = await votesResponse.json();

          if (votesData.error) throw new Error(votesData.message);
          
          const votes = votesData.rows || [];
          document.getElementById('live-votes').textContent = votes.length;
          document.getElementById('total-votes-stat').textContent = votes.length;
          
          const votesBody = document.getElementById('votes-list-body');
          votesBody.innerHTML = '';
          
          votes.slice(0, 10).forEach(item => {
              const row = votesBody.insertRow();
              // ATTENTION : Les cl√©s JSON doivent correspondre aux en-t√™tes exacts de votre feuille Sheets
              row.insertCell().textContent = item["Nom complet"] || 'Anonyme'; 
              row.insertCell().textContent = item["Fili√®re / Niveau"] || 'N/A';              
              row.insertCell().textContent = (item["Votre motivation"] || '').substring(0, 40) + '...'; 
          });
          if (votes.length === 0) votesBody.innerHTML = '<tr><td colspan="3">Aucun soutien enregistr√© pour l\'instant.</td></tr>';

          // --- 2. R√âCUP√âRER LES MEMBRES DE L'√âQUIPE (Feuille "Rejoindre l'√©quipe") ---
          // Utilise le param√®tre ?sheet=equipe
          const membersResponse = await fetch(GAS_FETCH_URL + '?sheet=equipe'); 
          const membersData = await membersResponse.json();

          if (membersData.error) throw new Error(membersData.message);

          const members = membersData.rows || [];
          document.getElementById('live-members').textContent = members.length;
          document.getElementById('total-members-stat').textContent = members.length;
          
          const membersBody = document.getElementById('members-list-body');
          membersBody.innerHTML = '';

          members.slice(0, 10).forEach(item => {
              const row = membersBody.insertRow();
              // ATTENTION : Les cl√©s JSON doivent correspondre aux en-t√™tes exacts de votre feuille Sheets
              row.insertCell().textContent = item["Nom complet"] || 'Anonyme'; 
              row.insertCell().textContent = item["Fili√®re / Niveau"] || 'N/A';              
              row.insertCell().textContent = item["R√¥le Souhait√©"] || 'Volontaire'; 
          });
          if (members.length === 0) membersBody.innerHTML = '<tr><td colspan="3">Aucun membre actif enregistr√© pour l\'instant.</td></tr>';

      } catch (error) {
          console.error('Erreur lors du chargement des statistiques:', error);
          errorDiv.classList.remove('d-none');
          document.getElementById('votes-list-body').innerHTML = '<tr><td colspan="3">√âchec du chargement</td></tr>';
          document.getElementById('members-list-body').innerHTML = '<tr><td colspan="3">√âchec du chargement</td></tr>';
      }
  }

  // Fonction 2 : Soumettre le formulaire (gestionnaire d'√©v√©nement)
  document.getElementById('joinForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      const form = e.target;
      const formData = new FormData(form);
      const formMessage = document.getElementById('form-message');
      
      formData.append('action', 'post_data'); // Action pour le script POST GAS (ajustez si besoin)

      formMessage.classList.remove('d-none', 'text-success', 'text-danger');
      formMessage.classList.add('text-muted');
      formMessage.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i> Envoi en cours...';

      try {
          // NOTE: On utilise GAS_POST_URL pour l'envoi des donn√©es
          const response = await fetch(GAS_POST_URL, {
              method: 'POST',
              body: formData,
          });

          // Le script POST GAS doit retourner un JSON avec {status: "SUCCESS"}
          const result = await response.json(); 

          if (result.status === 'SUCCESS') {
              formMessage.classList.remove('text-muted');
              formMessage.classList.add('text-success');
              formMessage.innerHTML = '<i class="fas fa-check-circle me-2"></i> Merci pour votre soutien et/ou votre engagement !';
              form.reset();
              fetchStats(); // Actualiser les stats apr√®s la soumission
          } else {
              throw new Error(result.message || 'Erreur inconnue du serveur GAS.');
          }

      } catch (error) {
          console.error('Erreur de soumission:', error);
          formMessage.classList.remove('text-muted');
          formMessage.classList.add('text-danger');
          formMessage.innerHTML = `<i class="fas fa-times-circle me-2"></i> √âchec de l'envoi. ${error.message}`;
      }
  });

  // Charger les statistiques au d√©marrage et les rafra√Æchir
  document.addEventListener('DOMContentLoaded', fetchStats);
  setInterval(fetchStats, 30000); // Rafra√Æchir toutes les 30 secondes pour le "live"

</script>
</body>
</html>
